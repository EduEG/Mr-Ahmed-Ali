<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login | Mr Ahmed Ali</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    body { background:#f5f6fa; }
    .login-container {
      max-width: 370px;
      background: #fff;
      margin: 5em auto 0 auto;
      padding: 2.2em 2.2em 1.6em 2.2em;
      border-radius: 14px;
      box-shadow: 0 4px 18px rgba(30,40,50,0.10);
      text-align: center;
    }
    .login-container h2 { margin-bottom: 1.4em; font-size: 1.6em; }
    .login-field { margin-bottom: 1.1em; text-align: left; }
    .login-field label { display: block; font-weight: 600; margin-bottom: 0.25em; }
    .login-field input[type="email"],
    .login-field input[type="password"] {
      width: 100%; padding: 0.65em; border-radius: 7px; border: 1px solid #bbb; font-size: 1.07em;
    }
    .login-actions { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.3em; }
    .login-actions label { font-size: 0.98em; font-weight: 500; }
    .login-btn, .signup-btn {
      background: var(--accent,#305080);
      color: #fff;
      font-weight: 700;
      border: none;
      border-radius: 7px;
      padding: 0.7em 1.4em;
      cursor: pointer;
      font-size: 1.07em;
      width: 100%;
      margin-bottom: 1.2em;
      margin-top: 0.3em;
    }
    .login-error, .signup-error {
      color: #c00;
      font-weight: 600;
      margin-bottom: 0.7em;
      min-height: 1.5em;
      text-align: center;
    }
    .divider {
      margin: 1.2em 0 0.8em 0;
      text-align: center; color: #888;
    }
  </style>
</head>
<body>
  <header>
    <div class="container header-flex">
      <a href="main.html" class="site-title">Mr Ahmed Ali</a>
    </div>
  </header>
  <main>
    <div class="container main-content">
      <section class="login-container">
        <h2>Sign In / Sign Up</h2>
        <form id="loginForm" autocomplete="off">
          <div class="login-field">
            <label for="email">Email</label>
            <input type="email" id="email" required autocomplete="username">
          </div>
          <div class="login-field">
            <label for="password">Password</label>
            <input type="password" id="password" required autocomplete="current-password">
          </div>
          <div class="login-actions">
            <label><input type="checkbox" id="rememberMe"> Remember Me</label>
          </div>
          <div class="login-error" id="errorMsg"></div>
          <button type="submit" class="login-btn">Login</button>
        </form>
        <div class="divider">or</div>
        <form id="signupForm" autocomplete="off">
          <div class="login-field">
            <label for="signup-email">Email</label>
            <input type="email" id="signup-email" required autocomplete="username">
          </div>
          <div class="login-field">
            <label for="signup-password">Password</label>
            <input type="password" id="signup-password" required autocomplete="new-password">
          </div>
          <div class="signup-error" id="signupErrorMsg"></div>
          <button type="submit" class="signup-btn">Sign Up</button>
        </form>
      </section>
    </div>
  </main>
  <!-- Firebase SDKs (modules, always load app/auth) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCAas2BelfwoxP2gEKCHeV67ksXOFyx73w",
      authDomain: "admin-panel-fdcf8.firebaseapp.com",
      databaseURL: "https://admin-panel-fdcf8-default-rtdb.firebaseio.com/",
      projectId: "admin-panel-fdcf8",
      storageBucket: "admin-panel-fdcf8.firebasestorage.app",
      messagingSenderId: "618047746883",
      appId: "1:618047746883:web:12849ada958f157f9975f6",
      measurementId: "G-J7NL949LX4"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // LOGIN
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const rememberMe = document.getElementById('rememberMe').checked;
      const errorMsg = document.getElementById('errorMsg');
      errorMsg.textContent = '';

      let persistence = rememberMe ?
        firebase.auth.Auth.Persistence.LOCAL :
        firebase.auth.Auth.Persistence.SESSION;

      auth.setPersistence(persistence)
        .then(() => auth.signInWithEmailAndPassword(email, password))
        .then((cred) => {
          if (email.toLowerCase() === "teacher@admin.com") {
            window.location.href = 'admin.html';
          } else {
            window.location.href = 'main.html';
          }
        })
        .catch(err => {
          let msg = "Invalid login. Please check your email/password.";
          if (err.code === 'auth/user-not-found') msg = "No user found with this email.";
          if (err.code === 'auth/wrong-password') msg = "Incorrect password.";
          if (err.code === 'auth/invalid-email') msg = "Invalid email address.";
          errorMsg.textContent = msg;
        });
    });

    // SIGN UP
    document.getElementById('signupForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('signup-email').value.trim();
      const password = document.getElementById('signup-password').value;
      const signupErrorMsg = document.getElementById('signupErrorMsg');
      signupErrorMsg.textContent = '';

      auth.createUserWithEmailAndPassword(email, password)
        .then((cred) => {
          if (email.toLowerCase() === "teacher@admin.com") {
            window.location.href = 'admin.html';
          } else {
            window.location.href = 'main.html';
          }
        })
        .catch(err => {
          let msg = "Could not sign up. Please check your details.";
          if (err.code === 'auth/email-already-in-use') msg = "Email is already in use.";
          if (err.code === 'auth/weak-password') msg = "Password should be at least 6 characters.";
          if (err.code === 'auth/invalid-email') msg = "Invalid email address.";
          signupErrorMsg.textContent = msg;
        });
    });
  </script>
</body>
</html>
